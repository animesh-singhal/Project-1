# **Finding Lane Lines on the Road** 

## Writeup Template

---

**Finding Lane Lines on the Road**

The goals / steps of this project are the following:
* Make a pipeline that finds lane lines on the road 
* Reflect on your work in a written report


[//]: # (Image References)

[image1]: ./examples/grayscale.jpg "Grayscale"

---

### Reflection

### 1. Description of my pipeline

My pipeline consisted of following steps: 

a) I first converted the given image to grayscale.

b) Then I applied a Gaussian filter on the image to smoothen it up before applying Canny Edge detection algorithm to it

c) Then in order to find edges in the image (based on the gradient of pixel intensity), I applied Canny Edge detection algorithm over the image. The result gave me thin edges which had lots individual pixels that follow the strongest gradients. The result had lines all over the image and it was important to perform the following steps: select a region of interest and draw straight lines (just like we do curve fitting in graphs)

d) Region of interest was found out using the technique of masking: 
- Firstly, based on the assumption that camera would be fixed at the front of the car, a constant area withing the image was identified in the form of a trapezium. Coordinates of the 4 vertices were taken based on trial and error method. It was ensured that entire lane has been covered in that area taking the small fluations in the position of the lane wrt. camera due to irregularities.   
- Next, an empty image having the same shape of our original image was generated. The trapezium was created over it and white color was filled inside it. Using the bitwise_and operator and the masking technique, only the area within the trapezium was retained in our image which was the output of Canny Edge Detection function.

e) Then straight lines were drawn in the region of interest using hough transforms. The idea is to detect intersections of curves in a unit grid in the hough space created by the parameters: Rho and Theta (which are the parameters when a line is expressed in polar coordinates). The hough function generates lines of desired color and thickness on the patches containing edges (generated by Canny Edge Detection Algorithm). The hough function takes a bunch of parameters as inputs and gives out cordinates of the end points of all the line segments that are the output of the function. 

Note: The challenge occurs when on side of the lane has discontinuous line segments instead of a continuous line all along the road. In such case, extrapolation of lines is required.

f) Extrapolating and joining the dis-joint line segments: Task is to find sufficient parameters to construct a singel line on teh left and right lane. 
Y=mX+c is the equation of the line used in this part. m=slope of the line. c= y intercept.
(x1,y1):top-coordinates and (x2,y2):bottom-coordinates are the two pair of coordinates that need to be found out to make one line. Here, we have to make a left and a right line of the lane. 

(i) Our line has to lie inside the region of interest defined by us previously so we know y1 and y2 for our line segments (based on the coordinates of our trapezium)
(ii) We will first find the slope(m) and 'x1' for the lines (as we already know 'y1'). Then we'll take the intersection of this line with the lower edge of the trapezium to find (x2,y2). The process shown here is done for one side of the lane. Same has to be repeated for the other part.
    - m is found by taking the averages of slope of the multiple lines lying on say the left edge of the lane. An allowed bound of m is also defined (refer the code)
    - For all those multiple lines lying on one edge of the lane (say left), intersection with the upper edge of the trapezium is taken to find the x coordinate of intersection for each line. The average of these values is taken and assigned to x1.
    - Now that we have (x1,y1) and m, we have all the information to construct a line. We take intersection of this line with the bottom edge of the trapezium to find (x2,y2) 
    - We join these lines and eventually form lines. These are superimposed on our original image to get the tracking lines over our lanes for our self-driving car to get some reference. 


If you'd like to include images to show how the pipeline works, here is how to include an image: 

![alt text][image1]


### 2. Potential shortcomings with my current pipeline

A few possible issues with the lane lines:  
1) Discontinuity 
2) Rubbed off due to wear and tear or rain in certain patches
3) Hidden due to shadows from trees, clouds, etc
4) The gradient might not be so strong for the canny edge detection function to detect it. Reasons: background color of the road (diffence in material used at different patches) 

These could result into no lines or very few lines given as output by the hough transform function due to insuffficient data points on the image. 

### 3. Possible improvements to my pipeline

A possible improvement would be to rely on the other side of the lane, in case one of them is not efficient.

In that case, this is how the line segment along the lane could be still generated: 
1) Finding slope: Assuming the lane edges to be mirror images, 
                            m_left = - (m_right)
If both fail, the slope can be taken equal to the inclined sides of the trapezium that we create to capture the region of interest

2) Finding x1 (x coordinate of the top end of the line. y coordinate is already known because of the trapezium):
The middle point of the upper edge of the trapezium is found. It is assumed that both the upper points of the right and left sides of the lane lie at equal distance from this middle point. Accordingly even if one coordinate is miising due to lack of information, other one can be found out. 

If both fail, the two upper vertices of the trapezium created by us to capture ROI can be taken as proxy.

3) With m,x1,y1 found as above, the rest of the procedure mentioned in the previous approach can be followed to draw the lines over the iamge.


Note_1: the vertices of the polygon used to capture the region of interest should be defined in a general fasion. This way, they won't fail when the resoultion of the input image changes. 

Note_2: While making the trapezium, some space could be left at the bottom and the trapezium can be formed a little above wrt to the way described above to take in account for the hood of the car (depends on where the camera is located on the car).

